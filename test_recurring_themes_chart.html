<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recurring Themes Chart Test - Synapse AI</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="static/css/style.css">
    <style>
        body {
            background: #0D1117;
            color: #C9D1D9;
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0;
            padding: 20px;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .test-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .test-header h1 {
            color: #58A6FF;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(88, 166, 255, 0.3);
        }
        
        .test-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(88, 166, 255, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 0 20px rgba(88, 166, 255, 0.1);
        }
        
        .test-section h2 {
            color: #58A6FF;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }
        
        .chart-container {
            background: rgba(13, 17, 23, 0.8);
            border: 1px solid rgba(88, 166, 255, 0.3);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            height: 400px;
            position: relative;
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .chart-title {
            color: #C9D1D9;
            font-size: 1.2rem;
            font-weight: 600;
            margin: 0;
        }
        
        .chart-status {
            font-size: 0.9rem;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 500;
        }
        
        .chart-status.loading {
            background: rgba(255, 193, 7, 0.2);
            color: #FFC107;
        }
        
        .chart-status.success {
            background: rgba(40, 167, 69, 0.2);
            color: #28A745;
        }
        
        .chart-status.error {
            background: rgba(220, 53, 69, 0.2);
            color: #DC3545;
        }
        
        .chart-status.placeholder {
            background: rgba(108, 117, 125, 0.2);
            color: #6C757D;
        }
        
        .chart-wrapper {
            height: 320px;
            position: relative;
        }
        
        .test-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .test-button {
            background: rgba(88, 166, 255, 0.2);
            border: 1px solid #58A6FF;
            color: #C9D1D9;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .test-button:hover {
            background: rgba(88, 166, 255, 0.3);
            box-shadow: 0 0 10px rgba(88, 166, 255, 0.3);
        }
        
        .test-results {
            background: rgba(13, 17, 23, 0.6);
            border: 1px solid rgba(88, 166, 255, 0.2);
            border-radius: 6px;
            padding: 15px;
            margin-top: 15px;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
            font-size: 0.85rem;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .success { color: #28A745; }
        .error { color: #DC3545; }
        .info { color: #58A6FF; }
        .warning { color: #FFC107; }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>Recurring Themes Chart Test</h1>
            <p>Testing enhanced horizontal bar chart with HUD styling and interactive features</p>
        </div>
        
        <div class="test-section">
            <h2>Chart Visualization Test</h2>
            <div class="test-controls">
                <button class="test-button" onclick="testWithSampleData()">Test with Sample Data</button>
                <button class="test-button" onclick="testWithRealData()">Test with Real Data</button>
                <button class="test-button" onclick="testWithEmptyData()">Test with Empty Data</button>
                <button class="test-button" onclick="testInteractivity()">Test Interactivity</button>
                <button class="test-button" onclick="testDataLabels()">Test Data Labels</button>
                <button class="test-button" onclick="clearChart()">Clear Chart</button>
            </div>
            
            <div class="chart-container glass-panel" id="recurring-themes-container">
                <div class="chart-header">
                    <h4 class="chart-title">Recurring Themes</h4>
                    <div class="chart-status" id="recurring-themes-status">Ready for testing</div>
                </div>
                <div class="chart-wrapper">
                    <canvas id="recurring-themes-chart" width="800" height="320"></canvas>
                </div>
            </div>
            
            <div class="test-results" id="test-results">
                <div class="info">Ready to run tests. Click buttons above to test different scenarios.</div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>Feature Verification</h2>
            <div id="feature-checklist">
                <div>✓ Horizontal bar chart implementation</div>
                <div>✓ HUD color scheme (#58A6FF cyan accents)</div>
                <div>✓ Enhanced hover effects with glow</div>
                <div>✓ Data labels showing frequencies</div>
                <div>✓ Detailed tooltips with percentages and rankings</div>
                <div>✓ Gradient bar colors based on frequency</div>
                <div>✓ Smooth animations with staggered delays</div>
                <div>✓ Theme descriptions in tooltips</div>
                <div>✓ Enhanced data extraction from memory insights</div>
                <div>✓ Error handling and recovery</div>
            </div>
        </div>
    </div>

    <script src="static/js/cognitive-charts.js"></script>
    <script>
        let chartManager;
        
        // Initialize chart manager
        function initializeChartManager() {
            const dashboard = document.querySelector('.test-container');
            chartManager = new CognitiveChartManager(dashboard);
            chartManager.init();
            log('Chart manager initialized', 'success');
        }
        
        // Test with sample data
        function testWithSampleData() {
            log('Testing with sample data...', 'info');
            
            const sampleData = {
                labels: ['Technology', 'Philosophy', 'Learning', 'Creativity', 'Science', 'Personal'],
                frequencies: [12, 8, 10, 6, 9, 7]
            };
            
            try {
                chartManager.createRecurringThemesChart(sampleData);
                log('Sample data test completed successfully', 'success');
                log(`Data: ${JSON.stringify(sampleData, null, 2)}`, 'info');
            } catch (error) {
                log(`Sample data test failed: ${error.message}`, 'error');
            }
        }
        
        // Test with simulated real data
        function testWithRealData() {
            log('Testing with simulated real data...', 'info');
            
            // Simulate memory insights data
            const simulatedInsights = [
                { content: 'discussing artificial intelligence and machine learning algorithms', confidence: 0.9, tags: ['technology', 'ai'] },
                { content: 'exploring philosophical questions about consciousness and reality', confidence: 0.8, tags: ['philosophy', 'consciousness'] },
                { content: 'learning new programming languages and development frameworks', confidence: 0.85, tags: ['learning', 'programming'] },
                { content: 'creative writing and artistic expression through digital media', confidence: 0.7, tags: ['creativity', 'art'] },
                { content: 'scientific research methods and data analysis techniques', confidence: 0.9, tags: ['science', 'research'] },
                { content: 'personal growth and self-improvement strategies', confidence: 0.75, tags: ['personal', 'growth'] }
            ];
            
            try {
                const themes = chartManager.extractRecurringThemes(simulatedInsights, {});
                const chartData = {
                    labels: themes.map(t => t.theme),
                    frequencies: themes.map(t => t.frequency)
                };
                
                chartManager.createRecurringThemesChart(chartData);
                log('Real data simulation test completed successfully', 'success');
                log(`Extracted themes: ${JSON.stringify(themes, null, 2)}`, 'info');
            } catch (error) {
                log(`Real data test failed: ${error.message}`, 'error');
            }
        }
        
        // Test with empty data
        function testWithEmptyData() {
            log('Testing with empty data...', 'info');
            
            try {
                chartManager.createRecurringThemesChart({ labels: [], frequencies: [] });
                log('Empty data test completed - should show default data', 'success');
            } catch (error) {
                log(`Empty data test failed: ${error.message}`, 'error');
            }
        }
        
        // Test interactivity
        function testInteractivity() {
            log('Testing chart interactivity...', 'info');
            log('Hover over bars to test interactive features:', 'info');
            log('- Hover effects with color changes', 'info');
            log('- Glow effects on canvas', 'info');
            log('- Detailed tooltips with percentages', 'info');
            log('- Cursor changes to pointer on hover', 'info');
        }
        
        // Test data labels
        function testDataLabels() {
            log('Testing data labels...', 'info');
            log('Data labels should appear on the right side of each bar', 'info');
            log('Labels should have glow effects and show frequency values', 'info');
        }
        
        // Clear chart
        function clearChart() {
            log('Clearing chart...', 'info');
            
            try {
                if (chartManager.charts.recurringThemes) {
                    chartManager.charts.recurringThemes.destroy();
                    chartManager.charts.recurringThemes = null;
                    log('Chart cleared successfully', 'success');
                } else {
                    log('No chart to clear', 'warning');
                }
            } catch (error) {
                log(`Clear chart failed: ${error.message}`, 'error');
            }
        }
        
        // Logging function
        function log(message, type = 'info') {
            const results = document.getElementById('test-results');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = type;
            logEntry.textContent = `[${timestamp}] ${message}`;
            results.appendChild(logEntry);
            results.scrollTop = results.scrollHeight;
            console.log(`[${type.toUpperCase()}] ${message}`);
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            log('Page loaded, initializing chart manager...', 'info');
            initializeChartManager();
        });
    </script>
</body>
</html>