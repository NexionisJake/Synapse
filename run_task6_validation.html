<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task 6 Validation Test Runner</title>
    <link rel="stylesheet" href="static/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <style>
        .test-output {
            background: rgba(0, 0, 0, 0.8);
            color: #00ff00;
            font-family: 'Courier New', monospace;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid #58A6FF;
        }

        .test-controls {
            display: flex;
            gap: 10px;
            margin: 20px 0;
        }
    </style>
</head>

<body>
    <div class="container glass-panel-strong" style="max-width: 1200px; margin: 2rem auto; padding: 2rem;">
        <header>
            <h1 class="hud-title">Task 6 Validation Test Runner</h1>
            <p class="hud-subtitle">Automated validation of Core Values radar chart implementation</p>
        </header>

        <div class="hud-divider glow"></div>

        <main>
            <section class="hud-card">
                <h2 class="hud-title" style="font-size: 1.2rem; margin-bottom: 1rem;">Test Controls</h2>
                <div class="test-controls">
                    <button id="run-validation" class="hud-button primary">
                        <span class="button-icon">üß™</span>
                        Run Full Validation
                    </button>
                    <button id="clear-output" class="hud-button secondary">
                        <span class="button-icon">üóëÔ∏è</span>
                        Clear Output
                    </button>
                    <button id="run-individual-tests" class="hud-button secondary">
                        <span class="button-icon">‚öôÔ∏è</span>
                        Run Individual Tests
                    </button>
                </div>
            </section>

            <section class="hud-card">
                <h2 class="hud-title" style="font-size: 1.2rem; margin-bottom: 1rem;">Test Output</h2>
                <div id="test-output" class="test-output">
                    Waiting for test execution...

                    Click "Run Full Validation" to start the automated test suite.
                </div>
            </section>

            <!-- Hidden chart container for testing -->
            <div style="display: none;">
                <canvas id="core-values-chart" width="300" height="200"></canvas>
                <div id="core-values-status"></div>
            </div>
        </main>
    </div>

    <!-- Load required scripts -->
    <script src="static/js/cognitive-charts.js"></script>
    <script src="test_task6_validation.js"></script>

    <script>
        // Override console methods to capture output
        const originalConsole = {
            log: console.log,
            error: console.error,
            warn: console.warn
        };

        let testOutput = '';
        const outputElement = document.getElementById('test-output');

        function captureConsoleOutput() {
            console.log = function (...args) {
                const message = args.join(' ');
                testOutput += message + '\n';
                outputElement.textContent = testOutput;
                outputElement.scrollTop = outputElement.scrollHeight;
                originalConsole.log(...args);
            };

            console.error = function (...args) {
                const message = '‚ùå ERROR: ' + args.join(' ');
                testOutput += message + '\n';
                outputElement.textContent = testOutput;
                outputElement.scrollTop = outputElement.scrollHeight;
                originalConsole.error(...args);
            };

            console.warn = function (...args) {
                const message = '‚ö†Ô∏è WARNING: ' + args.join(' ');
                testOutput += message + '\n';
                outputElement.textContent = testOutput;
                outputElement.scrollTop = outputElement.scrollHeight;
                originalConsole.warn(...args);
            };
        }

        function restoreConsoleOutput() {
            console.log = originalConsole.log;
            console.error = originalConsole.error;
            console.warn = originalConsole.warn;
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Bind event handlers
            document.getElementById('run-validation').addEventListener('click', runFullValidation);
            document.getElementById('clear-output').addEventListener('click', clearOutput);
            document.getElementById('run-individual-tests').addEventListener('click', runIndividualTests);
        });

        function runFullValidation() {
            clearOutput();
            captureConsoleOutput();

            testOutput += 'üöÄ Starting Task 6 Validation Test Suite...\n';
            testOutput += '================================================\n\n';
            outputElement.textContent = testOutput;

            try {
                // Run the validation function from test_task6_validation.js
                if (typeof validateTask6 === 'function') {
                    const result = validateTask6();
                    testOutput += '\n================================================\n';
                    testOutput += `üéØ Final Result: ${result ? '‚úÖ ALL TESTS PASSED' : '‚ùå SOME TESTS FAILED'}\n`;
                    testOutput += '================================================\n';
                } else {
                    testOutput += '‚ùå ERROR: validateTask6 function not found!\n';
                    testOutput += 'Make sure test_task6_validation.js is loaded correctly.\n';
                }
            } catch (error) {
                testOutput += `‚ùå ERROR during validation: ${error.message}\n`;
                testOutput += `Stack trace: ${error.stack}\n`;
            }

            outputElement.textContent = testOutput;
            outputElement.scrollTop = outputElement.scrollHeight;
            restoreConsoleOutput();
        }

        function runIndividualTests() {
            clearOutput();
            captureConsoleOutput();

            testOutput += 'üîß Running Individual Test Components...\n';
            testOutput += '=========================================\n\n';
            outputElement.textContent = testOutput;

            try {
                // Test 1: Chart Manager Availability
                testOutput += '1Ô∏è‚É£ Testing CognitiveChartManager availability...\n';
                if (typeof CognitiveChartManager !== 'undefined') {
                    testOutput += '   ‚úÖ CognitiveChartManager class found\n';

                    const chartManager = new CognitiveChartManager();
                    testOutput += '   ‚úÖ CognitiveChartManager instance created\n';

                    // Test methods
                    const methods = ['createCoreValuesChart', 'extractCoreValues', 'processMemoryDataForCharts'];
                    methods.forEach(method => {
                        if (typeof chartManager[method] === 'function') {
                            testOutput += `   ‚úÖ Method ${method} available\n`;
                        } else {
                            testOutput += `   ‚ùå Method ${method} missing\n`;
                        }
                    });
                } else {
                    testOutput += '   ‚ùå CognitiveChartManager not found\n';
                }

                // Test 2: CSS Variables
                testOutput += '\n2Ô∏è‚É£ Testing CSS custom properties...\n';
                const rootStyles = getComputedStyle(document.documentElement);
                const cssVars = ['--hud-accent-cyan', '--glass-blur', '--glow-medium'];
                cssVars.forEach(cssVar => {
                    const value = rootStyles.getPropertyValue(cssVar).trim();
                    if (value) {
                        testOutput += `   ‚úÖ ${cssVar}: ${value}\n`;
                    } else {
                        testOutput += `   ‚ùå ${cssVar}: not defined\n`;
                    }
                });

                // Test 3: Chart.js Availability
                testOutput += '\n3Ô∏è‚É£ Testing Chart.js availability...\n';
                if (typeof Chart !== 'undefined') {
                    testOutput += '   ‚úÖ Chart.js library loaded\n';
                    testOutput += `   ‚úÖ Chart.js version: ${Chart.version || 'unknown'}\n`;
                } else {
                    testOutput += '   ‚ùå Chart.js library not found\n';
                }

                // Test 4: Test Data Processing
                testOutput += '\n4Ô∏è‚É£ Testing data processing with sample data...\n';
                if (typeof testMemoryData !== 'undefined' && typeof CognitiveChartManager !== 'undefined') {
                    const chartManager = new CognitiveChartManager();
                    const processedData = chartManager.processMemoryDataForCharts(testMemoryData);

                    if (processedData && processedData.coreValues) {
                        testOutput += '   ‚úÖ Data processing successful\n';
                        testOutput += `   ‚úÖ Core values extracted: ${processedData.coreValues.values.join(', ')}\n`;
                    } else {
                        testOutput += '   ‚ùå Data processing failed\n';
                    }
                } else {
                    testOutput += '   ‚ùå Required components not available for data processing test\n';
                }

            } catch (error) {
                testOutput += `‚ùå ERROR during individual tests: ${error.message}\n`;
            }

            outputElement.textContent = testOutput;
            outputElement.scrollTop = outputElement.scrollHeight;
            restoreConsoleOutput();
        }

        function clearOutput() {
            testOutput = '';
            outputElement.textContent = 'Output cleared. Ready for new test run.';
        }
    </script>
</body>

</html>""